SELECT * FROM HOTEL H;

SELECT
    H.PKID_HOTEL AS ID_HOTEL,
    H.NOME AS NOME_HOTEL,
    H.ENDERECO_HOTEL.CIDADE AS CIDADE,
    DEREF(R.ESTADIAS).pk_cod_estadia AS CODIGO_ESTADIA,
    DEREF(R.ESTADIAS).VALOR_ESTADIA AS VALOR_ESTADIA,
    DEREF(R.ESTADIAS).DATA_CHECK_IN AS check_in,
    DEREF(R.ESTADIAS).DATA_CHECK_OUT AS check_out
FROM
    HOTEL H,
    TABLE(H.REGISTROS) R;
    
SELECT NOME_HOTEL,AVG(VALOR_ESTADIA), COUNT(L.ID_HOTEL) FROM (SELECT
    H.PKID_HOTEL AS ID_HOTEL,
    H.NOME AS NOME_HOTEL,
    H.ENDERECO_HOTEL.CIDADE AS CIDADE,
    DEREF(R.ESTADIAS).pk_cod_estadia AS CODIGO_ESTADIA,
    DEREF(R.ESTADIAS).VALOR_ESTADIA AS VALOR_ESTADIA,
    DEREF(R.ESTADIAS).DATA_CHECK_IN AS check_in,
    DEREF(R.ESTADIAS).DATA_CHECK_OUT AS check_out
FROM
    HOTEL H,
    TABLE(H.REGISTROS) R) L GROUP BY L.NOME_HOTEL;
    

SELECT * FROM (SELECT E.PK_COD_ESTADIA,E.DATA_CHECK_IN,E.DATA_CHECK_OUT,R.PASSAGEIROS.NOME,R.PASSAGEIROS.PK_CPF AS CPF_ESTADIA FROM ESTADIA E, TABLE(E.RESERVAS) R) J
INNER JOIN PASSAGEIRO_TB B ON J.CPF_ESTADIA=B.PK_CPF;
